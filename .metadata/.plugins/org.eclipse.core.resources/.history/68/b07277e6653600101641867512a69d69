package com.ecommerce.email.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.mail.SimpleMailMessage;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.stereotype.Service;

import com.ecommerce.email.model.OrderDto;

@Service
public class Sender {
	@Autowired
	private JavaMailSender sender;
	@KafkaListener(topics = "${spring.kafka.topic.name}", groupId = "${spring.kafka.consumer.group-id}")
	public void consumer(OrderDto order) {
		String to=order.getEmail();
		String subject="Order status "+ order.getStatus();
		String body=order.getMessage();
		sendEmail(to,subject,body);
	}
	public void sendEmail(String to,String subject,String text) {
		SimpleMailMessage message=new SimpleMailMessage();
		message.setTo(to);
		message.setSubject(subject);
		message.setText(text);
		sender.send(message);
		
	}
}
